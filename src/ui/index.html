<!DOCTYPE HTML>
<!--
	Hyperspace by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Yarle</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="assets/css/main.css" />

		<link rel="stylesheet" href="assets/css/eta-app.css" />
    <link rel="import" href="sections/enex.html">
    <link rel="import" href="sections/welcome.html">
    <link rel="import" href="sections/config.html">
	<link rel="import" href="sections/template.html">
	<link rel="import" href="sections/output.html">
	<link rel="import" href="sections/convert.html">
	</head>
	<body>

		<!-- Sidebar -->
			<section id="sidebar">
				<div class="inner">
					<nav>
						<ul>
							<li><a id="welcome-menu" data-section="welcome" href="#">Welcome</a></li>
							<li><a id="enex-menu" data-section="enex" href="#">Step 1: Select your Enex file</a></li>
							<li><a id="config-menu" data-section="config" href="#">Step 2: Configuration</a></li>
							<li><a id="template-menu" data-section="template" href="#">Step 3: Set up your Template</a></li>
							<li><a id="output-menu" data-section="output" href="#">Step 4: Pick your output location</a></li>
							<li><a id="convert-menu" data-section="convert" href="#">Step 5: Convert</a></li>

						</ul>
					</nav>
					<div class="version-info">
						Tested with Electron v5.0.8
					</div>
					<div class="version-info">
						(Currently running Electron v<script>document.write(process.versions.electron)</script>)
					</div>
				</div>
			</section>

		<!-- Wrapper -->
			<div id="wrapper">
			</div>

		<!-- Footer -->
			<footer id="footer" class="wrapper style1-alt">
				<div class="inner">
					<ul class="menu">
						<li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
					</ul>
				</div>
			</footer>

		<!-- Scripts -->
      <script>window.$ = window.jQuery = require('./assets/js/jquery.min.js');</script>
			<script>window.i18n = new(require('./translations/i18n'));</script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
      <script>
        require('./assets/js/menu')
				require('./assets/js/translations')
				require('./assets/js/ipc')
				require('./assets/js/dialog')
	  </script>
	  
	  <script type="text/javascript">
		/* const { ipcRenderer } = require("electron");
		const { cloneDeep } = require('lodash');
		const fs = require('fs');
		
		
		const enexFolderClick = document.getElementById('selectEnexFolder');
	
		enexFolderClick.addEventListener('click', function () {
		  ipcRenderer.send('openEnexSource');
		});
	
		document.getElementById('startConversion').addEventListener('click', function () {
		  startLogWatcher();
		})
		const outputFolderClick = document.getElementById('selectOutputFolder');
	
		outputFolderClick.addEventListener('click', function () {
		  ipcRenderer.send('selectOutputFolder');
		});
	
		const inputs = document.querySelectorAll('input');
		for (const input of inputs) {
		  input.addEventListener('input', updateValue);
		}
	
		function updateValue(e) {
		  ipcRenderer.send('configurationUpdated',
			{
			  id: e.target.id,
			  value: e.target.type === 'text' ? e.target.value : e.target.checked
			});
		}
		ipcRenderer.on('defaultTemplateLoaded', (event, store) => {
		  document.getElementById('templateArea').innerHTML = store;
		});
	
		ipcRenderer.on('currentEnexFiles', (event, store) => {
		  document.getElementById('currentEnexFiles').innerHTML = store;
		});
	
		ipcRenderer.on('enexSource', (event, store) => {
		  document.getElementById('enexSource').value = store;
		});
	
		ipcRenderer.on('outputDirectorySelected', (event, store) => {
		  document.getElementById('outputDirectory').value = store;
		})
		
		ipcRenderer.on('defaultTemplateLoaded', (event, store) => {
			document.getElementById('templateArea').innerHTML = store;
			});
		
		ipcRenderer.on('storedSettingsLoaded', (event, store) => {
		  for (const storeItemName of Object.keys(store)) {
			const entry = document.getElementById(storeItemName);
			console.log(`checking store: ${storeItemName}`)
			if (entry.type === 'checkbox') {
			  entry.checked = store[storeItemName] === true;
			} else {
			  entry.value = store[storeItemName];
			}
		  }
		})
	
	
	
		function openTab(evt, TabName) {
		  // Declare all variables
		  var i, tabcontent, tablinks;
	
		  // Get all elements with class="tabcontent" and hide them
		  tabcontent = document.getElementsByClassName("page-container");
		  for (i = 0; i < tabcontent.length; i++) {
			tabcontent[i].style.display = "none";
		  }
	
		  // Get all elements with class="tablinks" and remove the class "active"
		  // Show the current tab, and add an "active" class to the link that opened the tab
		  document.getElementById(TabName).style.display = "block";
		  evt.currentTarget.className += " active";
		}
	
		function startLogWatcher() {
		  var chokidar = require("chokidar");
		  const conversionFile = `${__dirname}/../../conversion.log`;
		  console.log('watching: ' + conversionFile);
		  var watcher = chokidar.watch(conversionFile, {
			ignored: /[\/\\]\./,
			persistent: true,
			usePolling: true
		  });
	
		  function onWatcherReady() {
			console.info('From here can you check for real changes, the initial scan has been completed.');
			ipcRenderer.send('startConversion');
	
		  }
	
		  // Declare the listeners of the watcher
		  watcher
			.on('change', function (path) {
	
			  document.getElementById('logArea').innerHTML = fs.readFileSync(path, 'UTF-8')
			})
			.on('ready', onWatcherReady)
	
		}
		*/
	  </script>

	</body>
</html>
